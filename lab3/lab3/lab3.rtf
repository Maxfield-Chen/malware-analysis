lab_03a.malware

1. There was a dll hidden inside the resources. I extracted it using the same as *.* method in resource hacker.
2. 
  -RegSetValueEx: Probably used to set some registry values for persistance. Maybe change other local user settings.
  -CoCreateInstance: A COM function indicates that it will be providing a shortcut to some singleton object. Indicates that this program will have CLSID's and some central form of communication through a COM Server.
  -Oleaut32.dll: Library is loaded so that the malware can take advantage of OLE Automation, another indicator of COM usage throughout the program and likely indicates that this malware will try to hijack certain programs using automation techniques.
  -Bonus: TerminateProcess: Indicates that this program will try to clean up after itself by terminating it's own process and or attempting to close other processes.
3.
  -"https://www.facebook.com/RPI-Computer-Security-Club-RPISEC-121207"... looking like this is some sort of advertisement for the RPI security club. Indicates that the malware will have a visual component to display this link. 
  - "BHO" Another hint that we're looking at a malicious COM Server running from a dll. Likely this indicates that our payload will be found through browser helper objects.
  - C:\\Users\\IEUser\\Downloads\\BHOinCPP_src\\BHOinCPP\\Release\\BHOinCPP.pdb this indicates that it will be using IE to download some debug information which is very interesting.          
4. It's using Browser helper objects to continually monitor your internet explorer web browsing. We can use these signatures to detect the virus by looking for: 
  -Software\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects\{3543619C-D563-43f7-95EA-4DA7E1CC396A}
5.CLSID\{3543619C-D563-43f7-95EA-4DA7E1CC396A}
6.IWebBrowser2 is the interface name.
7.Navigate and ExecWB

lab_03b.malware
1.
  -BF4F5B4FF7ED9C7275496C07F9836028
  -VirusTotal did not find this virus in its database.
2.
  -GetLogicalDrives: returns a bitmask representing the currently available disk drives. Could indicate that it will try to infect usb devices or maybe that it is trying to wipe a drive entirely.
  -createtoolhelp32snapshot: Returns a handle to a snapshot of a given process which includes heaps, modules and threads used by that module. Maybe this is some sort of persistance method or maybe it's used to verify that it's not being tampered with.
  -RTLUnwind: Unwinds the stack and calls any pending catch blocks. Suggests this program is doing something unusual with exceptions, maybe some sort of attack vector here?
3.
  -upfileok/upfileerr: these clearly indicate that the machine will be uploading some file and checking if it could do so successfully.
  -\java.exe: I suppose this indicates that the program will be trying to run some sort of external java script?
  -:\DOCUME~1\: This indicates that the malware will be messing with something in my documents or settings, maybe lowering security settings or the like.
4.
  -The primary method of persistance is a registry key at 'SOFTWARE\Microsoft\Windows\CurrentVersion\Run' which will run this program everytime a user logs in.
  -The host signature to look for would be a lab_3b.exe value inside the aforementioned autorun registry.
5. ListProcesses: 00402310, InteractiveRemoteShell:00402440 UploadFile: 004020F0
6.
  -ListProcesses: 7
  -InteractiveRemoteShell: 9
  -UploadFile: 5
7.
  -ListProcesses: Returns a buffer which contains all processes in the process list.
  -InteractiveRemoteShell: 
  -UploadFile: Returns a 0 or a 1 depending on if the file was uploaded successfully or not.
8. 
  -ListProcesses
    -CreateToolHelpSnapshot32: Saves all current processes to a buffer. This is the data that the malware can send externally.
    -Proccess32First: Provides access to the first process in the process buffer.
    -Proccess32Next: Provides access to the next process in the process buffer.
  -InteractiveRemoteShell:
    -CreatePipe: Used to open a connection to read the commands sent by the attacker.
    -PeakNamedPipe: Used to actually read those commands.
    -CreateProcessA: Used to execute those commands.
  -UploadFile:
    -CreateFileA: Used to create the file to send.
    -GetFileSizeA: Used to tell how many bytes to send over the connection.
    -CloseHandle: Ends the connection to the attacker.
9.
  -DeleteFile: Allows the attacker to specify a file to be deleted. CID = 4
  -RunProcessFromCommandLine: Allows the attacker to specify a program to be run by provide a command line. CID = 3
  -SendDriveInfo: Sends info about the users drive configuration CID = 1
