Submit by email.
malwarefall2015+lab1@gmail.com

lab1a.malware:

1. Creation at 2009/05/14 Thurs 17:12:41 UTC
2.
  a. Kernal32.dll has a bunch of functionality and seems like an interesting import. I know this program uses read / write files from the strings I found.
  b. Shell32.dll lets it execute a shell with ShellExecuteExA
  c. WS2_32.dll: with some quick googling this appears to be a winsockets library. Lets it hit that address I found later in strings.
3.
  a. There's an alphanumerical set which implies some sort of brute forcing.
  b. There's a reference to cmd.exe which implies that this program is going to try to pop a shell.
  c. There's a URL which points to http://www.ueopen.com/test.html which implied that this program will attempt to connect to that page.
4. Most noticable effect is that it immediately deletes itself. Next it alters imm32.dll which is a windows input library. It also uses WSHTCPIP.dll which is 
  a Windows networking dll. There are a couple other auxiliary dll's it modifies, but the next most interesting find is that it calls writefile on cmd.exe to delete itself.
5. I used a PID filter which excluded everything except lab1's exe. This let me cut down on all the auxiliary calls and hone in on the actions lab1 took. I also used operation filters to find only the regSetValue calls.
6. There are also a number of libraries you could verify as it modifies imm32.dll, WSHTCPIP.dll among others. A regshot analysis also reveals that rkycybere.rkr,
7. There is a host signature to http://www.ueopen.com/test.html, also while running it tries to contact 60.248.52.95. Examining the pcap file, I found that it has a get request for iexplore.exe.
8. The VM is actually a trouble it frequently crashed and required restarts. Solution is to update it.
9. I think this malware turns the computer into a bot, it tries to download a new version of iexplore.exe in order to take over the users computer.

lab1b.malware
1. md5hash: 02658BC9801F98DFDF167ACCF57F6A36 Virus total reports that this is a "generic backdoor". It also indicates that a shell was used and the imports suggest that it contacts the internet.
2.
  a. It imports InternetOpen/Connect A which means it's probably going to contact an external site.
  b. It imports HttpSendRequestA which indicates that it also sends data to that external site.
  c. It uses CreateProcessA which could mean that this is just the launch point for whatever larger program it downloads from an external site.

3. 
  a. '69.25.50.10' Likely a network signature
  b. 'wuauclt.exe' Possible name of larger executable that it intends to download and use. But upon further research, this is the windows autoupdate client. Maybe this was intended to prevent any further patches?
  c. '<head>\r\n' indicates that it is interacting in some capacity with html data.
4. There is a burst of cpu usage, causing lag but other than that there is no noticible effect.
5. I used the PID filter to cut down to only the lab executable. Then I used the Operation filter to look at all the register keys it set. My hope was to find some sort of method of persistance.
6. It stores a file in windows tasks for persistance, a scan for suspicious activitiy there should help determine if infected. Additionally, the windows registries for WPAD internet settings have been tampered with to use a new proxy network.
7. Yes, the above mentioned 69.25.50.10 ip address is used as a contact point. Fakenet reports a DNS request to 250.255.255.239.in-addr.arpa There are also several wpad requests which occur on execution of the malware which serve as good host indicators.
8. Getting used to the IDA workflow is a challenge which should be overcome with use and conversing with my classmates.
9. I think this malware is used to execute a WPAD Man in the Middle attack by downloading network proxy settings. Using Procmon I could tell that it overwrote several WPAD registry files and wiresharp indicates that it sends out several WPAD related requests.

Lab1c.malware
1. FileAlyzer Immediately show's that it's packed and has two extra odd sections: LOL0 and LOL1. Both Sections have execute and write enabled which were flagged as an anomaly. Packed with UPX from sourceforge.
2. upx.exe reports that the file is modified / hacked / protected.
3. 
  a. WININET.dll This indicates that it will probably have a network based component.
  b. InternetOpenA Further indication of network use.
  c. A full alphanumerical set indicates some form of bruteforcing.
4. A shell pops up and stays there. It doesn't have any other noticible effect. I expected that the malware would hide the shell to prevent the user's attention so this was unexpected. Closing the shell ends the process.
5. Again, it seems that many WPAD Registries have been written and settings for internet explorer have been touched.
6. Fakenet Detected a dns request to 250.255.255.239.in-addr.appa. Wireshark reports similar WPAD requests as seen is lab1b, but without being able to unpack the file further it is difficult to find other host signatures. 
8. The hacked upx packing made this very difficult to analyze. It prevented most types of static analysis and prevented me from using IDA to poke around the decompiled source. A quick look online suggests that the way to beat this packing is to fix the dump with ollydbg.
9. It's hard to tell without using ollydbg but I believe that this program acts similar to lab1b; acting as a MIM and stealing web traffic. It could also be used to redirect the user's requests and act as a botnet. 
